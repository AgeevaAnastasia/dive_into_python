"""CSV
CSV (–æ—Ç –∞–Ω–≥–ª. Comma-Separated Values ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –∑–∞–ø—è—Ç—ã–º–∏) ‚Äî
—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –°—Ç—Ä–æ–∫–∞
—Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç—Ä–æ–∫–µ —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–Ω–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π,
—Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—è—Ç—ã–º–∏.

CSV —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–∞–º, –≥–¥–µ —É–¥–æ–±–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö. –í—ã–≥—Ä—É–∑–∫–∏
–∏–∑ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö, –∏–∑ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.


–§–æ—Ä–º–∞—Ç CSV
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å CSV —Å—Ç–æ–∏—Ç –ø–æ–º–Ω–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –Ω–µ –¥–æ –∫–æ–Ω—Ü–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω.
–ù–∞–ø—Ä–∏–º–µ—Ä –∑–∞–ø—è—Ç–∞—è –∫–∞–∫ —Å–∏–º–≤–æ–ª —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç —è–≤–ª—è—Ç—å—Å—è —á–∞—Å—Ç—å—é —Ç–µ–∫—Å—Ç–∞. –ß—Ç–æ–±—ã –Ω–µ
—É—á–∏—Ç—ã–≤–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—è—Ç—ã–µ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏. –ù–æ —Ç–æ–≥–¥–∞ –∫–∞–≤—ã—á–∫–∏ –Ω–µ –º–æ–≥—É—Ç
–±—ã—Ç—å —á–∞—Å—Ç—å—é —Å—Ç—Ä–æ–∫–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ –¥–µ—Å—è—Ç–∏—á–Ω–∞—è –∑–∞–ø—è—Ç–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–ø–∏—Å–∏
–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö. –í—Å–µ —ç—Ç–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
—É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å CSV —Ñ–∞–π–ª–∞–º–∏.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç–µ—Å—Ç–æ–≤—ã–π CSV —Ñ–∞–π–ª biostats.csv:

"Name","Sex","Age","Height (in)","Weight (lbs)"
"Alex","M",41,74,170
"Bert","M",42,68,166
"Carl","M",32,70,155
"Dave","M",39,72,167
"Elly","F",30,66,124
"Fran","F",33,66,115
"Gwen","F",26,64,121
"Hank","M",30,71,158
"Ivan","M",53,72,175
"Jake","M",32,69,143
"Kate","F",47,69,139
"Luke","M",34,72,163
"Myra","F",23,62,98
"Neil","M",36,75,160
"Omar","M",38,70,145
"Page","F",31,67,135
"Quin","M",29,71,176
"Ruth","F",28,65,131

–í –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–∞–∫ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ. –°—Ç—Ä–æ–∫–∏
—Å–æ –≤—Ç–æ—Ä–æ–π –∏ –¥–æ –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∑–∞–ø–∏—Å–∏. –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ ‚Äî –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å.
–¢–µ–∫—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞–∫–ª—é—á–µ–Ω–∞ –≤ –∫–∞–≤—ã—á–∫–∏, –∞ —á–∏—Å–ª–∞ —É–∫–∞–∑–∞–Ω—ã –±–µ–∑ –Ω–∏—Ö.
–ü–æ–¥–æ–±–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ CSV —Ñ–∞–π–ª—ã –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å –≤—ã–≥—Ä—É–∑–∏–≤ –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel –∏–ª–∏
–¥—Ä—É–≥–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —É–∫–∞–∑–∞–≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü–æ —Å—É—Ç–∏ CSV —è–≤–ª—è–µ—Ç—Å—è
–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º —Ñ–∞–π–ª–æ–º –º–µ–∂–¥—É Excel –∏ Python.


–ú–æ–¥—É–ª—å CSV
–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –≤ Python –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å csv. –î–ª—è –µ–≥–æ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–º–ø–æ—Ä—Ç–∞ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞:
import csv

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥—É–ª—è.
‚óè –ß—Ç–µ–Ω–∏–µ CSV
–§—É–Ω–∫—Ü–∏—è csv.reader –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Ñ–∞–π–ª–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ —á–∏—Ç–∞–µ—Ç
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é."""

import csv

with open('biostats.csv', 'r', newline='') as f:
    csv_file = csv.reader(f)
    for line in csv_file:
        print(line)
        print(type(line))


"""üî• –í–∞–∂–Ω–æ! –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å CSV –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä newline=‚Äô‚Äô –≤–æ
–≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞.

–ö—Ä–æ–º–µ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π
–∏—Ç–µ—Ä–∞—Ü–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å—Ç—Ä–æ–∫–∏. –¢–∞–∫–∂–µ —Ñ—É–Ω–∫—Ü–∏—è reader –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å
–¥–∏–∞–ª–µ–∫—Ç –æ—Ç–ª–∏—á–Ω—ã–π –æ—Ç –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî ‚Äúexcel‚Äù. –ê –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —Ñ–∞–π–ª –∏–º–µ–µ—Ç —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏.

–§–∞–π–ª biostats_tab_bad.csv —Ö—Ä–∞–Ω–∏—Ç —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –∏ —Ñ–∞–π–ª –≤—ã—à–µ, –Ω–æ –≤–º–µ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏–º–≤–æ–ª —Ç–∞–±—É–ª—è—Ü–∏–∏. –ü–æ —Å—É—Ç–∏ —ç—Ç–æ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç—å TSV ‚Äî —Ñ–∞–π–ª —Å
—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º —Ç–∞–±—É–ª—è—Ü–∏–µ–π:

"Name"  "Sex"   "Age"   "Height (in)"   "Weight (lbs)"
"Alex"  "M" 41  74  170
"Bert"  "M" 42  68  166
"Carl"  "M" 32  70  155
"Dave"  "M" 39  72  167
"Elly"  "F" 30  66  124
"Fran"  "F" 33  66  115
"Gwen"  "F" 26  64  121
"Hank"  "M" 30  71  158
"Ivan"  "M" 53  72  175
"Jake"  "M" 32  69  143
"Kate"  "F" 47  69  139
"Luke"  "M" 34  72  163
"Myra"  "F" 23  62  98
"Neil"  "M" 36  75  160
"Omar"  "M" 38  70  145
"Page"  "F" 31  67  135
"Quin"  "M" 29  71  176
"Ruth"  "F" 28  65  131


–î–æ–±–∞–≤–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –µ–≥–æ —á—Ç–µ–Ω–∏—è"""

import csv

with open('biostats_tab_bad.csv', 'r', newline='') as f:
    csv_file = csv.reader(f, dialect='excel-tab', quoting=csv.QUOTE_NONNUMERIC)
    for line in csv_file:
        print(line)
        print(type(line))


"""
‚û¢ dialect='excel-tab' ‚Äî —É–∫–∞–∑–∞–ª–∏ –¥–∏–∞–ª–µ–∫—Ç —Å —Ç–∞–±—É–ª—è—Ü–∏–µ–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
‚û¢ quoting=csv.QUOTE_NONNUMERIC ‚Äî –ø–µ—Ä–µ–¥–∞–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É,
—É–∫–∞–∑—ã–≤–∞—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ —á–∏—Å–ª–∞ –±–µ–∑ –∫–∞–≤—ã—á–µ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∫
—Ç–∏–ø—É float.



‚óè –ó–∞–ø–∏—Å—å CSV
–î–ª—è –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏—é writer, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç
–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç CSV. –§—É–Ω–∫—Ü–∏—è writer –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª–æ–≤—ã–π
–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø–∏—Å–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
—Ñ—É–Ω–∫—Ü–∏–∏ reader. –ü—Ä–∏ —ç—Ç–æ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –ø–æ–∫–∞ —É –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω–æ–≥–æ
–æ–±—ä–µ–∫—Ç–∞ –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥ writerow –¥–ª—è –∑–∞–ø–∏—Å–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ writerows –¥–ª—è
–∑–∞–ø–∏—Å–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫.
–†–∞—Å—Å–º–æ—Ç—Ä–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ."""

import csv

with (
    open('biostats_tab_bad.csv', 'r', newline='') as f_read,
    open('new_biostats.csv', 'w', newline='', encoding='utf-8') as f_write
):
    csv_read = csv.reader(f_read, dialect='excel-tab', quoting=csv.QUOTE_NONNUMERIC)
    csv_write = csv.writer(f_write, dialect='excel', delimiter=' ', quotechar='|', quoting=csv.QUOTE_MINIMAL)
    all_data = []
    for i, line in enumerate(csv_read):
        if i == 0:
            csv_write.writerow(line)
        else:
            line[2] += 1
            for j in range(2, 4 + 1):
                line[j] = int(line[j])
            all_data.append(line)
    csv_write.writerows(all_data)


"""
1. –ò—Å–ø–æ–ª—å–∑—É—è –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ with –æ—Ç–∫—Ä—ã–ª–∏ –¥–≤–∞ —Ñ–∞–π–ª–∞. –ò–∑ –ø–µ—Ä–≤–æ–≥–æ —á–∏—Ç–∞–µ–º
–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∞ –≤—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞—ë–º –¥–ª—è –∑–∞–ø–∏—Å–∏.
2. –§—É–Ω–∫—Ü–∏—è reader –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç csv_read –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä –≤—ã—à–µ.
3. –§—É–Ω–∫—Ü–∏—è writer –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç csv_write –¥–ª—è –∑–∞–ø–∏—Å–∏. –ú—ã —É–∫–∞–∑–∞–ª–∏:
    a. –¥–∏–∞–ª–µ–∫—Ç ‚Äúexcel‚Äù
    b. –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–±–µ–ª
    c. –µ—Å–ª–∏ —Å–∏–º–≤–æ–ª —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å (–ø—Ä–æ–±–µ–ª) –µ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã—Ö, —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –∏—Ö
–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π —á–µ—Ä—Ç–æ–π
    d. —Å–∏–º–≤–æ–ª —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ –º–∏–Ω–∏–º—É–º, —Ç–æ–ª—å–∫–æ —Ç–∞–º –≥–¥–µ –æ–Ω
–Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º
4. –í —Ü–∏–∫–ª–µ —á–∏—Ç–∞–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª. –ü—Ä–∏ —ç—Ç–æ–º —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
—Å—Ä–∞–∑—É –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –º–µ—Ç–æ–¥–æ–º writerow.
5. –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤–æ–∑—Ä–∞—Å—Ç –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º
–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞ –≤ —Ü–µ–ª—ã–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –≤ –º–∞—Ç—Ä–∏—Ü—É all_data
6. –û–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º writerows(all_data) —Å–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ç—Ä–∏—Ü—É –≤ —Ñ–∞–π–ª.



‚óè –ß—Ç–µ–Ω–∏–µ –≤ —Å–ª–æ–≤–∞—Ä—å
–ü–æ–º–∏–º–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ —Å–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—å.
–ö–ª—é—á–∏ —Å–ª–æ–≤–∞—Ä—è ‚Äî –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤, –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî –æ—á–µ—Ä–µ–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ CSV.
–ü—Ä–æ—á–∏—Ç–∞–µ–º —Ñ–∞–π–ª biostats_tab_bad.csv –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ, –Ω–æ –Ω–µ –≤ —Å–ø–∏—Å–æ–∫, –∞ –≤ —Å–ª–æ–≤–∞—Ä—å.
–í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫–ª–∞—Å—Å–æ–º DictReader."""

import csv

with open('biostats_tab_bad.csv', 'r', newline='') as f:
    csv_file = csv.DictReader(f, fieldnames=["name", "sex", "age", "height", "weight", "office"],
                              restkey="new", restval="Main Office", dialect='excel-tab',
                              quoting=csv.QUOTE_NONNUMERIC)
    for line in csv_file:
        print(f'{line = }')
        print(f'{line["name"] = }\t{line["age"] = }')



"""–ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä fieldnames, –æ–Ω–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è
–∫–ª—é—á–µ–π —Å–ª–æ–≤–∞—Ä—è, –∞ –Ω–µ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø–µ—Ä–µ–¥–∞–Ω ‚Äú–ª–∏—à–Ω–∏–π‚Äù
–∫–ª—é—á count. –¢.–∫. –≤ —Ç–∞–±–ª–∏—Ü–µ –Ω–µ—Ç —à–µ—Å—Ç–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞, –µ–º—É –±—ã–ª–æ –ø—Ä–∏—Å–≤–æ–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑
–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ restval."""

import csv

with open('biostats_tab_bad.csv', 'r', newline='') as f:
    csv_file = csv.DictReader(f, fieldnames=["name", "sex", "age", ],
                              restkey="new", restval="Main Office",
                              dialect='excel-tab',
                              quoting=csv.QUOTE_NONNUMERIC)
    for line in csv_file:
        print(f'{line = }')
        print(f'{line["name"] = }\t{line["age"] = }')

"""
–ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–µ–Ω—å—à–µ, —á–µ–º —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –∫–ª—é—á
–±–µ—Ä—ë—Ç—Å—è –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ restkey. –ü—Ä–∏ —ç—Ç–æ–º –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã –±–µ–∑ –∫–ª—é—á–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫
—ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–∞ –≤ restkey –∫–ª—é—á.



‚óè –ó–∞–ø–∏—Å—å –∏–∑ —Å–ª–æ–≤–∞—Ä—è
–î–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è –≤ CSV –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–ª–∞—Å—Å DictWriter. –ï–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
—Å—Ö–æ–∂–∏ —Å —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–º–∏ –≤—ã—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ DictReader."""

import csv
from typing import Iterator

with (
    open('biostats_tab_bad.csv', 'r', newline='') as f_read,
    open('biostats_new.csv', 'w', newline='', encoding='utf-8') as f_write
):
    csv_read: Iterator[dict] = csv.DictReader(f_read, fieldnames=["name", "sex", "age", "height", "weight", "office"],
                                              restval="Main Office",
                                              dialect='excel-tab',
                                              quoting=csv.QUOTE_NONNUMERIC)
    csv_write = csv.DictWriter(f_write, fieldnames=["id", "name", "office", "sex", "age", "height", "weight"],
                               dialect='excel-tab',
                               quoting=csv.QUOTE_ALL)
    csv_write.writeheader()
    all_data = []
    for i, dict_row in enumerate(csv_read):
        if i != 0:
            dict_row['id'] = i
            dict_row['age'] += 1
            all_data.append(dict_row)
    csv_write.writerows(all_data)



"""–ö–ª–∞—Å—Å DictWriter –ø–æ–ª—É—á–∏–ª —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π –¥–ª—è –∑–∞–ø–∏—Å–∏, –≥–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ id. –í
–∫–∞—á–µ—Å—Ç–≤–µ –¥–∏–∞–ª–µ–∫—Ç–∞ –≤—ã–±—Ä–∞–Ω excel —Å —Ç–∞–±—É–ª—è—Ü–∏–µ–π. –í –ø–∞—Ä–∞–º–µ—Ç—Ä–µ quoting —É–∫–∞–∑–∞–ª–∏, —á—Ç–æ –≤—Å–µ
–∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–∏—Ç –∑–∞–∫–ª—é—á–∞—Ç—å –≤ –∫–∞–≤—ã—á–∫–∏.
–ù–æ–≤—ã–π –¥–ª—è –Ω–∞—Å –º–µ—Ç–æ–¥ writeheader —Å–æ—Ö—Ä–∞–Ω–∏–ª –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –≤ —Ç–æ–º
–ø–æ—Ä—è–¥–∫–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã –∏—Ö –ø–µ—Ä–µ—á–∏—Å–ª–∏–ª–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ fieldnames. –î–∞–ª–µ–µ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º
—Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Å–ª–æ–≤–∞—Ä—è –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ –≤
—Ñ–∞–π–ª.

üî• –í–∞–∂–Ω–æ! –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∏–º–ø–æ—Ä—Ç –æ–±—ä–µ–∫—Ç–∞ Iterator –∏–∑ –º–æ–¥—É–ª—è typing.
–ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞ IDE –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–ª–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏, —Ç–∞–∫ –∫–∞–∫ –Ω–µ
–ø–æ–Ω–∏–º–∞–ª–∞ —á—Ç–æ –∑–∞ –æ–±—ä–µ–∫—Ç csv_read. –ó–∞–ø–∏—Å—å csv_read: Iterator[dict] = ‚Ä¶ —Å–æ–æ–±—â–∞–µ—Ç,
—á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ä–µ–∫—Ç –∏—Ç–µ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä–∏. –ü–æ—Å–ª–µ
—É—Ç–æ—á–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ IDE –∏—Å–∫–ª—é—á–∏–ª–∞ –ø–æ–¥—Å–≤–µ—Ç–∫—É ‚Äú–æ—à–∏–±–æ–∫‚Äù.
"""